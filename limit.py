from premium_db import has_active_premium
from usage_db import get_today_usage, log_usage

DAILY_LIMIT = 3  # –ª–∏–º–∏—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞ –≤ —Å—É—Ç–∫–∏


def check_limit(user_id: int):
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
      (True, None)  ‚Äî –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–ª–∏–º–∏—Ç –Ω–µ –ø—Ä–µ–≤—ã—à–µ–Ω –∏–ª–∏ –µ—Å—Ç—å –ø—Ä–µ–º–∏—É–º)
      (False, text) ‚Äî –ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–µ–Ω, text —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """

    # –ü—Ä–µ–º–∏—É–º-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Äî –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
    if has_active_premium(user_id):
        log_usage(user_id)
        return True, None

    used = get_today_usage(user_id)

    if used >= DAILY_LIMIT:
        msg = (
            "üö´ *–õ–∏–º–∏—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞ ‚Äî 3 –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å—É—Ç–∫–∏.*\n\n"
            "–í –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ —Ç—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.\n\n"
            "–ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, "
            "–ø–æ–¥–∫–ª—é—á–∏ *–ü—Ä–µ–º–∏—É–º* üöÄ\n\n"
            "üì¶ *–¢–∞—Ä–∏—Ñ—ã:*\n"
            "‚Ä¢ 1 –º–µ—Å—è—Ü ‚Äî *490 —Å–æ–º*\n"
            "‚Ä¢ 6 –º–µ—Å—è—Ü–µ–≤ ‚Äî *1990 —Å–æ–º*\n"
            "‚Ä¢ 1 –≥–æ–¥ ‚Äî *2990 —Å–æ–º*\n\n"
            "üßë‚Äçüíº –î–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–∞–ø–∏—à–∏ –º–µ–Ω–µ–¥–∂–µ—Ä—É:\n"
            "@Artbazar_support"
        )
        return False, msg

    # –õ–∏–º–∏—Ç –Ω–µ –ø—Ä–µ–≤—ã—à–µ–Ω ‚Äî —Å—á–∏—Ç–∞–µ–º –∑–∞–ø—Ä–æ—Å
    log_usage(user_id)
    return True, None
